- defaults:
    link:
      create: true
      relink: true

- brewfile:
  - brew/Brewfile
  - brew/Brewfile.git
  - brew/Brewfile.secure
  - brew/Brewfile.aws
  - brew/Brewfile.development
  - brew/Brewfile.k8s
  - brew/Brewfile.networking
  - brew/Brewfile.fonts
  
- shell:
  - brew cu -y && brew update && brew upgrade && brew cleanup --force
  - rm -f -r /Library/Caches/Homebrew/*

- pip:
    file: pip/requirements.txt
    binary: /usr/local/bin/pip3
    user: true    # Like --user
    stdout: true # Print the execution stdout
    stderr: true  # Print the execution stderr

- clean: ['~']

- create:
    - ~/test-downloads
    - ~/undo-history
    - ~/locals

- link:
    ~/.vimrc:
      path: vim/vimrc
    ~/.gitconfig:
      path: git/gitconfig
    ~/.gitconfig.alias:
      path: git/gitconfig.alias
    ~/.gitconfig.message:
      path: git/gitconfig.message
    ~/.gitattributes:
      path: git/gitattributes
    ~/.aliases:
      path: shell/aliases
    ~/.bashrc:
      path: shell/bashrc
    ~/.exports:
      path: shell/exports
    ~/.profile:
      path: shell/profile
    ~/.dotfiles-local:
      path: dotfiles-local

- clean: ['~']


# TODO: should pull tagged/release one
- shell:
  - [echo 'cd dotfiles && ./install.sh' > ~/run.sh, Execute from parent folder]
  # the following have to run after linking ~/.gitconfig
  - git pull --recurse-submodules
  - git submodule update --init --recursive
  - git submodule foreach git pull origin master

- defaults:
    link:
      create: true
      relink: true

- brewfile:
  - brew/Brewfile
  - brew/Brewfile.git
  - brew/Brewfile.secure
  - brew/Brewfile.aws
  - brew/Brewfile.k8s
  - brew/Brewfile.networking
  - brew/Brewfile.fonts
  - brew/Brewfile.development
  # - brew/Brewfile.mas
  # - brew/Brewfile.vms

- shell:
  - brew cu -y && brew update && brew upgrade && brew cleanup

- pip:
    file: pip/requirements.txt
    binary: /usr/local/bin/pip3
    user: true   # Like --user
    stdout: true # Print the execution stdout
    stderr: true # Print the execution stderr

- clean: ['~']

- create:
    - ~/undo-history
    - ~/locals
    - ~/Library/ApplicationSupport/iTerm2/DynamicProfiles
    - ~/.tmuxp

- link:
    ~/.vimrc:
      path: vim/vimrc
    ~/.gitconfig:
      path: git/gitconfig
    ~/.gitconfig.alias:
      path: git/gitconfig.alias
    ~/.gitconfig.message:
      path: git/gitconfig.message
    ~/.gitconfig.include:
      path: git/gitconfig.message
    ~/.gitattributes:
      path: git/gitattributes
    ~/.aliases:
      path: shell/aliases
    ~/.bashrc:
      path: shell/bashrc
    ~/.exports:
      path: shell/exports
    ~/.functions:
      path: shell/functions
    ~/.profile:
      path: shell/profile
    ~/.locals:
      path: locals
    ~/.zshrc:
      path: zsh/zshrc
    ~/.zprofile:
      path: zsh/settings/zprofile
    ~/.zsh/functions:
      path: zsh/functions
    ~/.zsh/settings:
      path: zsh/settings
    ~/.zpreztorc:
      path: zsh/settings/zpreztorc
    ~/.gnupg/gpg.conf:
      path: gnupg/gpg.conf
    ~/.gnupg/gpg-agent.conf:
      path: gnupg/gpg-agent.conf
    ~/.zprezto:
      path: vendor/prezto
    /usr/local/etc/tor/torrc:
      path: browser/tor/torrc
    ~/.bash-it:
      path: vendor/bash-it
    ~/Library/ApplicationSupport/iTerm2/DynamicProfiles/profile.json:
      path: iTerm/profiles.json
    ~/.config/starship.toml:
      path: zsh/settings/
    ~/.tmuxp/configs:
      path: tmux/configs/
    ~/.tmuxp/aliases:
      path: tmux/aliases


# TODO: should pull tagged/release one
- shell:
  - [echo 'cd dotfiles && ./install.sh' > ~/run.sh, Execute from parent folder]
  - git pull --recurse-submodules
  - git submodule update --init --recursive
  - git submodule foreach git pull origin master
  - [sudo chsh -s $(which zsh), Making zsh the default shell]
  - echo "My current shell is $SHELL ($0)"
  - archey -c
